var TKIT=TKIT||{};TKIT.ContextMenu={},TKIT.ContextMenu.create=function(e,t,n,T){TKIT.ContextMenu.active&&TKIT.ContextMenu.destroy(),TKIT.ContextMenu.active=!0,TKIT.ContextMenu.centerX=n||0,TKIT.ContextMenu.centerY=T||0,TKIT.ContextMenu.items=e,TKIT.ContextMenu.actions=t,TKIT.ContextMenu.objects=[],document.addEventListener("mousemove",TKIT.ContextMenu.Events.mousemove,!1),document.addEventListener("click",TKIT.ContextMenu.Events.click,!1),TKIT.ContextMenu.createMenu()},TKIT.ContextMenu.createMenu=function(){for(var e=0;e<TKIT.ContextMenu.items.length;e++)!function(e){var t=TKIT.ContextMenu.items[e];setTimeout(function(){TKIT.ContextMenu.createItem(t,e)},100*e)}(e)},TKIT.ContextMenu.createItem=function(e,t){var n=(TKIT.ContextMenu.event,e.labelText),T=e.action,o=document.createElement("canvas");o.id="TKITContextMenuCanvas",document.body.appendChild(o);var r=document.getElementById("TKITContextMenuCanvas");r.width=1024,r.height=256;var i=r.getContext("2d");i.fillStyle="white",i.fillRect(0,0,r.width,r.height),i.font="112px Arial",i.fillStyle="black",i.fillText(n,32,164);var c=r.toDataURL("image/png"),s=new Image;s.src=c,document.body.appendChild(s);var a=new THREE.Vector3;a.set(TKIT.ContextMenu.centerX/window.innerWidth*2-1,2*-(TKIT.ContextMenu.centerY/window.innerHeight)+1,.5),a.unproject(TKIT.camera);var I=a.sub(TKIT.camera.position).normalize(),K=-TKIT.camera.position.z/I.z,u=TKIT.camera.position.clone().add(I.multiplyScalar(K)),d=new THREE.Texture(s);d.needsUpdate=!0;var m=new THREE.BoxGeometry(256,64,100),x=new THREE.MeshPhongMaterial({map:d,color:13492478,specular:1118481,shininess:30,shading:THREE.SmoothShading}),l=new THREE.Mesh(m,x);l.position.set(u.x,u.y-64*t,-1e3),l.contextmenuaction=T;var C=TKIT.ContextMenu.objects.push(l);TKIT.scene.add(TKIT.ContextMenu.objects[C-1]),setInterval(function(){l.position.z<0&&(l.position.z=l.position.z+100)},16)},TKIT.ContextMenu.destroy=function(){if(TKIT.ContextMenu.active){TKIT.ContextMenu.active=!1,document.removeEventListener("mousemove",TKIT.ContextMenu.Events.mousemove),document.removeEventListener("click",TKIT.ContextMenu.Events.click);for(var e=0;e<TKIT.ContextMenu.objects.length;e++)TKIT.scene.remove(TKIT.ContextMenu.objects[e]);TKIT.ContextMenu.objects=[]}},TKIT.ContextMenu.Events={},TKIT.ContextMenu.Events.mousemove=function(e){for(var t=TKIT.IntersectObject.intersects(e,TKIT.scene,TKIT.camera),n=0;n<TKIT.ContextMenu.objects.length;n++)TKIT.ContextMenu.objects[n].material.color.setHex(13492478);t.length>0&&t[0].object.material.color.setHex(16777215)},TKIT.ContextMenu.Events.click=function(e){var t=TKIT.IntersectObject.intersects(e,TKIT.scene,TKIT.camera);t.length>0&&TKIT.ContextMenu.actions[t[0].object.contextmenuaction](),TKIT.ContextMenu.destroy()};var TKIT=TKIT||{};TKIT.init=function(e,t){TKIT.scene=e,TKIT.camera=t};var TKIT=TKIT||{};TKIT.IntersectObject={},TKIT.IntersectObject.raycaster=new THREE.Raycaster,TKIT.IntersectObject.mouse=new THREE.Vector2,TKIT.IntersectObject.intersects=function(e,t,n){return TKIT.IntersectObject.mouse.x=e.clientX/window.innerWidth*2-1,TKIT.IntersectObject.mouse.y=2*-(e.clientY/window.innerHeight)+1,TKIT.IntersectObject.raycaster.setFromCamera(TKIT.IntersectObject.mouse,n),TKIT.IntersectObject.raycaster.intersectObjects(t.children)};var TKIT=TKIT||{};TKIT.scenes={},TKIT.scenes.generate=function(e){const t=TKIT.scenes.types[e];if("function"==typeof t)return t()},TKIT.scenes.types={},TKIT.scenes.types.basic=function(){TKIT.scene=new THREE.Scene,TKIT.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e4),TKIT.camera.position.z=600,TKIT.light=new THREE.PointLight(16777215,1,0),TKIT.light.position.set(0,0,1e3),TKIT.scene.add(TKIT.light),TKIT.renderer=new THREE.WebGLRenderer({antialias:!0}),TKIT.renderer.setClearColor(15790320),TKIT.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(TKIT.renderer.domElement),TKIT.render=function(){requestAnimationFrame(TKIT.render),TKIT.renderer.render(TKIT.scene,TKIT.camera)},TKIT.render(),window.addEventListener("resize",function(){TKIT.camera.aspect=window.innerWidth/window.innerHeight,TKIT.camera.updateProjectionMatrix(),TKIT.renderer.setSize(window.innerWidth,window.innerHeight)})};